## bash

1. Напишите конвейер, который будет использовать команды ps, grep и awk для мониторинга активных процессов в системе. Результаты должны быть отсортированы по использованию ресурсов, и информация должна быть записана в файл «system_monitoring.txt».
```bash
ps aux --sort -%mem | grep -v grep | awk '{print $1, $2, $4, $11}' > system_monitoring.txt
```
2. Напишите конвейер, который сравнивает содержимое двух директорий. Используйте команды find, sort, и diff для поиска и сравнения файлов в двух директориях. Результат сравнения сохраните в файл «directory_comparison.txt».
*! Вводите полный путь к директории, а не ~/ или относительные пути*
Запускаемый файл **file_diff.sh**
```sh
#!/bin/bash

# Запрос путей к директориям у пользователя
read -p "Введите путь к первой директории: " dir1
read -p "Введите путь ко второй директории: " dir2

# Проверка, существуют ли указанные директории
if [ ! -d "$dir1" ] || [ ! -d "$dir2" ]; then
  echo "Одна из директорий не существует. Проверьте пути"
  exit 1
fi

# Сравнение содержимого директорий и запись в файл
diff <(find "$dir1" -type f | sort) <(find "$dir2" -type f | sort) > directory_comparison.txt

echo "done"
```
3. Напишите конвейер для подсчета общего числа строк во всех текстовых файлах в указанной директории, используя find, xargs и wc.
*! Вводите полный путь к директории, а не ~/ или относительные пути*
Запускаемый файл **count_lines.sh**

```sh
#!/bin/bash

# Запрос пути к директории у пользователя
read -p "Введите путь к директории: " dir

# Проверка, существует ли указанная директория
if [ ! -d "$dir" ]; then
  echo "Директория не существует. Проверьте путь"
  exit 1
fi

# Подсчет общего числа строк во всех текстовых файлах
total_lines=$(find "$dir" -type f -name "*.txt" | xargs wc -l | awk '{total += $1} END {print total}')

echo "Количество строк в текстовых файлах: $total_lines"
```
4. Напишите конвейер, который использует команды df, sort и awk для мониторинга использования дискового пространства и записывает результаты в файл «disk_space_usage.txt».
```bash
df -h | sort -hr -k 5 > disk_space_usage.txt
```
5. Напишите конвейер, который использует команды cat, grep, awk, sort и tar для фильтрации строк с ключевым словом в лог-файлах, сортировки и архивации результатов.
*! Вводите полный путь к директории, а не ~/ или относительные пути.* Запускаемый файл **filter_logs.sh**
```sh
#!/bin/bash

# Запрос пути к лог-файлам у пользователя
read -p "Введите путь к логам: " log_path
# Запрос ключевого слова у пользователя
read -p "Введите ключевое слово: " keyword

# Проверка, существует ли указанная директория
if [ ! -d "$log_path" ]; then
  echo "Директория не существует. Проверьте путь"
  exit 1
fi

# Фильтрация, сортировка и архивация результатов
cat "$log_path"/*.log 2>/dev/null | grep "$keyword" | sort > filtered_results.txt && tar -czf filtered_results.tar.gz filtered_results.txt

echo "done"
```
2.1. Напишите Bash-скрипт для анализа лог-файлов в указанной директории. Скрипт должен найти все файлы с расширением «.log» в указанной директории и подсчитать количество строк, содержащих определенное ключевое слово (например, «ERROR» или «Exception»). Ключевое слово должно быть задано в переменной в начале скрипта. Скрипт должен выводить сообщение в формате: «Файл [ИМЯ ФАЙЛА] содержит [КОЛИЧЕСТВО СТРОК С КЛЮЧЕВЫМ СЛОВОМ] строк с ключевым словом [КЛЮЧЕВОЕ СЛОВО]». В конце скрипта выведите общее количество строк с ключевым словом по всем лог-файлам в данной директории.
```sh
#!/bin/bash

# Запрос списка хостов у пользователя
read -p "Введите IP-адреса или доменные имена хостов (через пробел): " -a hosts

# Проверка, был ли введен хотя бы один хост
if [ ${#hosts[@]} -eq 0 ]; then
  echo "Ошибка: Не введен ни один хост."
  exit 1
fi

# Инициализация счетчиков
available=0
unavailable=0

# Проверка доступности каждого хоста
for host in "${hosts[@]}"; do
  if ping -c 1 "$host" &> /dev/null; then
    echo "Хост $host доступен"
    ((available++))
  else
    echo "Хост $host недоступен"
    ((unavailable++))
  fi
done

# Вывод общего количества доступных и недоступных хостов
echo "Всего доступных хостов: $available"
echo "Всего недоступных хостов: $unavailable"
```
2.2 Напишите Bash-скрипт для анализа лог-файлов в указанной директории. Скрипт должен найти все файлы с расширением «.log» в указанной директории и подсчитать количество строк, содержащих определенное ключевое слово (например, «ERROR» или «Exception»). Ключевое слово должно быть задано в переменной в начале скрипта. Скрипт должен выводить сообщение в формате: «Файл [ИМЯ ФАЙЛА] содержит [КОЛИЧЕСТВО СТРОК С КЛЮЧЕВЫМ СЛОВОМ] строк с ключевым словом [КЛЮЧЕВОЕ СЛОВО]». В конце скрипта выведите общее количество строк с ключевым словом по всем лог-файлам в данной директории.
```sh
#!/bin/bash

# Запрос пути к лог-файлам у пользователя
read -p "Введите путь к директории с логами: " log_directory
# Запрос ключевого слова у пользователя
read -p "Введите ключевое слово для поиска: " keyword

# Проверка существования директории
if [ ! -d "$log_directory" ]; then
  echo "Ошибка: Директория $log_directory не существует."
  exit 1
fi

total_count=0

# Поиск всех .log файлов в указанной директории
shopt -s nullglob # Чтобы не обрабатывать *.log как строку, если файлов нет
for log_file in "$log_directory"/*.log; do
  if [ -f "$log_file" ]; then
    # Подсчет строк с ключевым словом в текущем лог-файле
    count=$(grep -c "$keyword" "$log_file" 2>/dev/null)
    
    # Проверка на ошибки при выполнении grep
    if [ $? -ne 0 ]; then
      echo "Ошибка при анализе файла $log_file. Возможно, у вас нет прав доступа."
      continue
    fi
    
    # Вывод информации о текущем файле
    echo "Файл $log_file содержит $count строк с ключевым словом '$keyword'"
    
    # Увеличение общего счетчика
    total_count=$((total_count + count))
  else
    echo "Файл $log_file не найден или это не обычный файл."
  fi
done

# Вывод общего количества строк с ключевым словом
echo "Общее количество строк с ключевым словом '$keyword' во всех лог-файлах: $total_count"
```
